<?xml version="1.0" ?>
<lsc xmlns="http://lsc-project.org/XSD/lsc-core-2.2.xsd" revision="0">
	<connections>
		<ldapConnection>
			<name>ldap-src-conn</name>
			<url>ldap://localhost:33389/dc=lsc-project,dc=org</url>
			<username>cn=Directory Manager</username>
			<password>secret</password>
			<authentication>SIMPLE</authentication>
			<referral>IGNORE</referral>
			<derefAliases>NEVER</derefAliases>
			<version>VERSION_3</version>
			<pageSize>-1</pageSize>
			<factory>com.sun.jndi.ldap.LdapCtxFactory</factory>
			<tlsActivated>false</tlsActivated>
		</ldapConnection>
		<ldapConnection>
			<name>ldap-dst-conn</name>
			<url>ldap://192.168.183.177:389/DC=foo,DC=bar</url>
			<username>provisioning@FOO.BAR</username>
			<password>Prov2012!</password>
			<authentication>SIMPLE</authentication>
			<referral>IGNORE</referral>
			<derefAliases>NEVER</derefAliases>
			<version>VERSION_3</version>
			<pageSize>-1</pageSize>
			<factory>com.sun.jndi.ldap.LdapCtxFactory</factory>
			<tlsActivated>false</tlsActivated>
		</ldapConnection>
	</connections>
	<tasks>
		<task>
			<name>People</name>
			<bean>org.lsc.beans.SimpleBean</bean>
			<ldapSourceService>
				<name>openldap-source-service</name>
				<connection reference="ldap-src-conn" />
				<baseDn>ou=People,dc=lsc-project,dc=org</baseDn>
				<pivotAttributes>
					<string>uid</string>
				</pivotAttributes>
				<fetchedAttributes>
					<string>description</string>
					<string>cn</string>
					<string>sn</string>
					<string>userPassword</string>
					<string>objectClass</string>
					<string>uid</string>
					<string>mail</string>
				</fetchedAttributes>
				<getAllFilter>(objectClass=inetorgperson)</getAllFilter>
				<getOneFilter>(&amp;(objectClass=inetorgperson)(uid={uid}))</getOneFilter>
				<cleanFilter>(&amp;(objectClass=inetorgperson)(sn=bahloul)(uid={samAccountName}))</cleanFilter>
			</ldapSourceService>
			<ldapDestinationService>
				<name>ad-dst-service</name>
				<connection reference="ldap-dst-conn" />
				<baseDn>CN=Users,DC=foo,DC=bar</baseDn>
				<pivotAttributes>
					<string>samAccountName</string>
				</pivotAttributes>
				<fetchedAttributes>
					<string>description</string>
					<string>cn</string>
					<string>sn</string>
					<string>givenName</string>
					<string>objectClass</string>
					<string>samAccountName</string>
				</fetchedAttributes>
				<getAllFilter>(objectClass=user)</getAllFilter>
				<getOneFilter>(&amp;(objectClass=user)(samAccountName={uid}))</getOneFilter>
			</ldapDestinationService>
			<propertiesBasedSyncOptions>
				<mainIdentifier>"CN=" + srcBean.getDatasetFirstValueById("cn") +
					",CN=Users,DC=foo,DC=bar"</mainIdentifier>
				<defaultDelimiter>;</defaultDelimiter>
				<defaultPolicy>FORCE</defaultPolicy>
				<dataset>
					<name>description</name>
					<policy>FORCE</policy>
					<forceValues>
						<string>js:srcBean.getDatasetFirstValueById("sn").toUpperCase() +
							" (" + srcBean.getDatasetFirstValueById("mail") + ")"</string>
					</forceValues>
				</dataset>
				<dataset>
					<name>samAccountName</name>
					<policy>KEEP</policy>
					<createValues>
						<string>js:srcBean.getDatasetFirstValueById("uid")</string>
					</createValues>
				</dataset>
				<dataset>
					<name>objectClass</name>
					<policy>KEEP</policy>
					<createValues>
						<string>"user"</string>
					</createValues>
				</dataset>
				<dataset>
					<name>userPassword</name>
					<policy>KEEP</policy>
					<createValues>
						<string>"changethis"</string>
					</createValues>
				</dataset>
			</propertiesBasedSyncOptions>
		</task>
	</tasks>
</lsc>
